{
  "tasks": [
    {
      "id": "1",
      "title": "数据库 schema 更新",
      "description": "在 prisma/schema.prisma 的 Comment 模型里新增 guestName 字段（String? 可空），authorId 改为可空（Int?）。然后运行 npx prisma generate 生成新的客户端。注意：不要运行 prisma migrate，只运行 prisma generate。",
      "status": "pending"
    },
    {
      "id": "2",
      "title": "评论 API 支持游客",
      "description": "修改 app/api/articles/[slug]/comments/route.ts 的 POST 接口：1. 支持游客评论，请求体新增 guestName 字段；2. 未登录时 guestName 必填（2-20字），已登录时忽略 guestName；3. IP 限流：同一 IP 每分钟最多 3 条评论，超出返回 429；4. 内容长度限制 1-500 字；5. 游客评论 authorId 为 null，guestName 存入数据库；6. 游客评论同样触发 AI 自动回复（createAIReply）。GET 接口返回评论时带上 guestName 字段。",
      "status": "pending",
      "dependsOn": ["1"]
    },
    {
      "id": "3",
      "title": "前端评论组件更新",
      "description": "修改 components/article/CommentSection.tsx：1. 判断用户是否登录（从 AuthContext 获取）；2. 未登录时显示昵称输入框（必填，placeholder='你的昵称'）和评论内容框；3. 已登录时和现在一样，不显示昵称框；4. 评论列表展示时，游客评论（authorId 为 null）显示 guestName + '（游客）' 标识，用不同颜色区分；5. 提交时把 guestName 带入请求体。",
      "status": "pending",
      "dependsOn": ["2"]
    }
  ]
}
